window.jQuery&&function(t){if(!t.support.opacity&&!t.support.style)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(t){}t.fn.rating=function(a){if(0==this.length)return this;if("string"==typeof arguments[0]){if(this.length>1){var r=arguments;return this.each(function(){t.fn.rating.apply(t(this),r)})}return t.fn.rating[arguments[0]].apply(this,t.makeArray(arguments).slice(1)||[]),this}a=t.extend({},t.fn.rating.options,a||{});return t.fn.rating.calls++,this.not(".star-rating-applied").addClass("star-rating-applied").each(function(){var r,i=t(this),n=(this.name||"unnamed-rating").replace(/\[|\]/g,"_").replace(/^\_+|\_+$/g,""),s=t(this.form||document.body),e=s.data("rating");e&&e.call==t.fn.rating.calls||(e={count:0,call:t.fn.rating.calls});var l=e[n]||s.data("rating"+n);l&&(r=l.data("rating")),l&&r?r.count++:((r=t.extend({},a||{},(t.metadata?i.metadata():t.meta?i.data():null)||{},{count:0,stars:[],inputs:[]})).serial=e.count++,l=t('<span class="star-rating-control"/>'),i.before(l),l.addClass("rating-to-be-drawn"),(i.attr("disabled")||i.hasClass("disabled"))&&(r.readOnly=!0),i.hasClass("required")&&(r.required=!0));var d=t('<div role="text" aria-label="'+this.title+'" class="tzstar-rating rater-'+r.serial+'"><a title="'+(this.title||this.value)+'">'+this.value+"</a></div>");if(l.append(d),this.id&&d.attr("id",this.id),this.className&&d.addClass(this.className),r.half&&(r.split=2),"number"==typeof r.split&&r.split>0){var h=(t.fn.width?d.width():0)||r.starWidth,u=r.count%r.split,c=Math.floor(h/r.split);d.width(c).find("a").css({"margin-left":"-"+u*c+"px"})}r.readOnly?d.addClass("star-rating-readonly"):d.addClass("star-rating-live").on("mouseover",function(){t(this).rating("fill"),t(this).rating("focus")}).on("mouseout",function(){t(this).rating("draw"),t(this).rating("blur")}).on("click",function(){t(this).rating("select")}),this.checked&&(r.current=d),"A"==this.nodeName&&t(this).hasClass("selected")&&(r.current=d),i.hide(),i.on("change.rating",function(a){if(a.selfTriggered)return!1;t(this).rating("select")}),d.data("rating.input",i.data("rating.star",d)),r.stars[r.stars.length]=d[0],r.inputs[r.inputs.length]=i[0],r.rater=e[n]=l,r.context=s,i.data("rating",r),l.data("rating",r),d.data("rating",r),s.data("rating",e),s.data("rating"+n,l)}),t(".rating-to-be-drawn").rating("draw").removeClass("rating-to-be-drawn"),this},t.extend(t.fn.rating,{calls:0,focus:function(){var a=this.data("rating");if(!a)return this;if(!a.focus)return this;var r=t(this).data("rating.input")||t("INPUT"==this.tagName?this:null);a.focus&&a.focus.apply(r[0],[r.val(),t("a",r.data("rating.star"))[0]])},blur:function(){var a=this.data("rating");if(!a)return this;if(!a.blur)return this;var r=t(this).data("rating.input")||t("INPUT"==this.tagName?this:null);a.blur&&a.blur.apply(r[0],[r.val(),t("a",r.data("rating.star"))[0]])},fill:function(){var t=this.data("rating");if(!t)return this;t.readOnly||(this.rating("drain"),this.prevAll().addBack().filter(".rater-"+t.serial).addClass("star-rating-hover"))},drain:function(){var t=this.data("rating");if(!t)return this;t.readOnly||t.rater.children().filter(".rater-"+t.serial).removeClass("star-rating-on").removeClass("star-rating-hover")},draw:function(){var a=this.data("rating");if(!a)return this;this.rating("drain");var r=t(a.current),i=r.length?r.prevAll().addBack().filter(".rater-"+a.serial):null;i&&i.addClass("star-rating-on"),this.siblings()[a.readOnly?"addClass":"removeClass"]("star-rating-readonly")},select:function(a,r){var i=this.data("rating");if(!i)return this;if(!i.readOnly){if(i.current=null,void 0!==a||this.length>1){if("number"==typeof a)return t(i.stars[a]).rating("select",void 0,r);if("string"==typeof a)return t.each(i.stars,function(){t(this).data("rating.input").val()==a&&t(this).rating("select",void 0,r)}),this}else i.current="INPUT"==this[0].tagName?this.data("rating.star"):this.is(".rater-"+i.serial)?this:null;this.data("rating",i),this.rating("draw");var n=t(i.current?i.current.data("rating.input"):null),s=t(i.inputs).filter(":checked");return t(i.inputs).not(n).prop("checked",!1),n.prop("checked",!0),t(n.length?n:s).trigger({type:"change",selfTriggered:!0}),(r||null==r)&&i.callback&&i.callback.apply(n[0],[n.val(),t("a",i.current)[0]]),this}},readOnly:function(a,r){var i=this.data("rating");if(!i)return this;i.readOnly=!(!a&&null!=a),r?t(i.inputs).attr("disabled","disabled"):t(i.inputs).removeAttr("disabled"),this.data("rating",i),this.rating("draw")},disable:function(){this.rating("readOnly",!0,!0)},enable:function(){this.rating("readOnly",!1,!1)}}),t.fn.rating.options={cancel:"Cancel Rating",cancelValue:"",split:0,starWidth:16}}(jQuery);